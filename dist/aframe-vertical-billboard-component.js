!function(){"use strict";function e(e){var t=e.data.width,i=e.data.height;if(0===t&&0===i&&(i=1),0===t||0===i){var a=e.Texture;if(null!=a&&null!=a.image&&a.image.complete&&0!==a.image.naturalWidth&&0!==a.image.naturalHeight){var s=a.image.naturalWidth/a.image.naturalHeight;0===t?t=i*s:i=t/s}}e.Mesh.scale.set(t,i,1),e.Mesh.position.set(0,i/2,0)}delete AFRAME.components.billboard,AFRAME.registerComponent("billboard",{dependencies:["camera"],schema:{map:{type:"map"},width:{type:"number"},height:{type:"number"}},init:function(){this.Texture=void 0,this.Material=new THREE.MeshBasicMaterial({transparent:!0,alphaTest:.5}),this.Mesh=new THREE.Mesh(new THREE.PlaneGeometry(1,1),this.Material),this.Group=new THREE.Group,this.Group.add(this.Mesh),this.el.setObject3D("mesh",this.Group),this.Origin=new THREE.Vector3,this.Target=new THREE.Vector3},update:function(t){var i=this;if(null==t||null==t.map||t.map!==this.data.map){null!=this.Texture&&this.Texture.dispose();var a=this.data.map;this.Texture=(new THREE.TextureLoader).load(a instanceof Image?a.src:a,(function(t){i.Material.map=t,i.Material.needsUpdate=!0,e(i)}))}null!=t&&t.width===this.data.width&&t.height===this.data.height||e(this)},tick:function(){this.el.sceneEl.getObject3D("camera").getWorldPosition(this.Target),this.Group.getWorldPosition(this.Origin),this.Target.setY(this.Origin.y),this.Group.lookAt(this.Target)},remove:function(){null!=this.Mesh&&this.el.removeObject3D("mesh"),null!=this.Texture&&this.Texture.dispose(),null!=this.Material&&this.Material.dispose()}}),null==AFRAME.primitives.primitives["a-billboard"]?AFRAME.registerPrimitive("a-billboard",{defaultComponents:{billboard:{}},mappings:{map:"billboard.map",width:"billboard.width",height:"billboard.height"}}):console.warn('an A-Frame primitive called "a-billboard" exists already')}();
//# sourceMappingURL=aframe-vertical-billboard-component.js.map
